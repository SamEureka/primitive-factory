<!DOCTYPE html>
<html>
<head>
    <title>Flask App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.2/css/bulma.min.css">
</head>
<body>
    <div class="container">
        <h1 class="title">Flask App</h1>

        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="notification is-info">
            <button class="delete"></button>
            {% for message in messages %}
            <p>{{ message }}</p>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <form method="POST" enctype="multipart/form-data" action="{{ url_for('index') }}">
            <div class="field">
                <div class="file is-info has-name">
                    <label class="file-label">
                        <input class="file-input" type="file" name="file" id="file-upload">
                        <span class="file-cta">
                            <span class="file-icon">
                                <i class="fas fa-upload"></i>
                            </span>
                            <span class="file-label">
                                Choose a fileâ€¦
                            </span>
                        </span>
                        <span class="file-name" id="file-name">
                            No file chosen
                        </span>
                    </label>
                </div>
            </div>
            <div class="field">
                <div class="control">
                    <button class="button is-primary" type="submit">Upload and Convert</button>
                </div>
            </div>
        </form>

        <div class="columns is-multiline">
            {% for card in cards %}
            <div class="column is-one-quarter">
                <div class="card">
                    <div class="card-image">
                        <figure class="image">
                          <img src="{{ url_for('static', filename=card.image_path) }}" alt="Uploaded Image">
                        </figure>
                    </div>
                    <div class="card-content">
                        <div class="media">
                            <div class="media-content">
                                <p class="title is-4">{{ card.filename }}</p>
                            </div>
                        </div>
                        <div class="content">
                          <a href="{{ url_for('static', filename=card.image_path) }}" download>Download</a> 
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="field">
          <div class="control">
              <a href="{{ url_for('photos') }}" class="button is-link">View Uploaded Photos</a>
          </div>
      </div>

    </div>

    <script src="{{ url_for('static', filename='fontawesome-free-5.15.3-web/js/all.js') }}"></script>
    <script>
        // Display selected file name
        const fileInput = document.getElementById('file-upload');
        const fileName = document.getElementById('file-name');
        fileInput.addEventListener('change', function() {
            fileName.textContent = this.files[0].name;
        });

        // Close flash messages
        const deleteButtons = document.querySelectorAll('.delete');
        deleteButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                this.parentNode.parentNode.remove();
            });
        });
    </script>
</body>
</html>
